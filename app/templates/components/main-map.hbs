{{#if glSupported}}

  {{#if map}}

    {{yield (hash
      call=(component 'mapbox-gl-call' obj=map)
      control=(component 'mapbox-gl-control' map=map)
      image=(component 'mapbox-gl-image' map=map)
      layer=(component 'mapbox-gl-layer' map=map)
      marker=(component 'mapbox-gl-marker' map=map)
      on=(component 'mapbox-gl-on' eventSource=map)
      popup=(component 'mapbox-gl-popup' map=map)
      source=(component 'mapbox-gl-source' map=map)
    )}}

    {{!-- Bind layer groups' layers --}}
    {{#each model.layerGroups key='id' as |layerGroup|}}
      {{#if layerGroup.visible}}
        {{#each layerGroup.layers as |layerObject|}}
          {{component 'mapbox-gl-layer' 
              map=map 
              layer=layerObject.style}}
        {{/each}}
      {{/if}}
    {{/each}}

    {{mapbox-gl-on 'click' (action 'handleMouseClick') eventSource=map}}

  {{/if}}
{{else}}
  {{yield to='inverse'}}
{{/if}}
